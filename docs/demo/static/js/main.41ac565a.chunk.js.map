{"version":3,"sources":["SampleAnalyst.js","App.js","serviceWorker.js","index.js"],"names":["SampleAnalyst","sourceCode","run","goalOutput","goalSourceCode","isLive","Object","classCallCheck","this","undefined","sourcePieces","exec","toLowerCase","test","splitSource","split","result","display","output","goalResult","diffs","diffChars","goalLineNumber","goalColumnNumber","outputLineNumber","outputColumnNumber","matchCount","mismatchCount","allMarkers","map","diff","lineCount","value","match","length","lastGoalLine","lastGoalColumn","lastOutputLine","lastOutputColumn","added","removed","marker","startRow","startCol","endRow","endCol","className","type","lastNewLine","lastIndexOf","goalMarkers","filter","outputMarkers","forEach","matchPercentage","PythonContext","React","createContext","ProgressBar","stateClass","props","percentage","react_default","a","createElement","style","width","concat","Component","Editor","_this","possibleConstructorReturn","getPrototypeOf","call","state","selectedLine","content","createRef","handleScroll","bind","assertThisInitialized","onScroll","current","editor","session","getScrollTop","setScrollTop","scrollTop","setState","gotoLine","resize","lib_default","ref","onChange","readOnly","onSelectionChange","onCursorChange","mode","theme","height","fontSize","showPrintMargin","markers","showGutter","highlightActiveLine","editorProps","$blockScrolling","Infinity","setOptions","showLineNumbers","tabSize","FootnoteBuilder","coreProps","href","name","children","CodeSample","_this2","codeRunner","context","window","analyze","analyst","isPythonLoaded","source","originalSource","handleChange","handleReset","handleCursorChange","newSource","selection","selectionLead","row","prevProps","prevState","text","displayValue","displayEditor","progressBar","outputHeaders","outputSection","resetButton","sourceLineCount","countLines","App_Editor","onClick","outputLineCount","goalLineCount","outputSize","Math","min","max","App_ProgressBar","contextType","App","_this3","app","tutorials","pythonMessage","languagePluginLoader","then","pyodide","loadPackage","runPython","search","location","tutorialName","URLSearchParams","get","Provider","react_markdown_default","renderers","code","link","Boolean","hostname","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.41ac565a.chunk.js","sourcesContent":["import { diffChars } from 'diff';\n\nexport default class SampleAnalyst {\n\n    constructor(sourceCode, run, goalOutput, goalSourceCode, isLive) {\n        if (goalSourceCode !== undefined) {\n            this.sourceCode = sourceCode;\n            this.goalSourceCode = goalSourceCode;\n            this.isLive = true;\n        } else if (isLive === false) {\n            this.sourceCode = sourceCode;\n            this.isLive = isLive;\n        } else {\n            let sourcePieces =\n                /^(.*\\n)?( *##+ *((static)|(live))[ #]*\\n)(.*)$/is.exec(\n                    sourceCode);\n            if (sourcePieces !== null) {\n                this.sourceCode = (sourcePieces[1] || \"\") + sourcePieces[6];\n                this.isLive = sourcePieces[3].toLowerCase() === \"live\";\n            } else if (/>>>/.test(sourceCode)) {\n                this.sourceCode = sourceCode;\n                this.isLive = false;\n            } else {\n                this.isLive = true;\n                let splitSource = sourceCode.split(/ *##+ *Goal[ #]*\\n/i);\n                this.sourceCode = splitSource[0];\n                this.goalSourceCode = splitSource[1];\n            }\n        }\n        if (run !== undefined && this.isLive) {\n            let result = run(this.sourceCode);\n            this.display = result[0];\n            this.output = result[1];\n\n            if (goalOutput !== undefined) {\n                this.goalOutput = goalOutput;\n            } else if (this.goalSourceCode !== undefined) {\n                let goalResult = run(this.goalSourceCode);\n                this.goalOutput = goalResult[1];\n            }\n            if (this.goalOutput !== undefined) {\n                let diffs = diffChars(this.goalOutput, this.output),\n                    goalLineNumber = 0,\n                    goalColumnNumber = 0,\n                    outputLineNumber = 0,\n                    outputColumnNumber = 0,\n                    matchCount = 0,\n                    mismatchCount = 0,\n                    allMarkers = diffs.map(diff => {\n                        let lineCount = (diff.value.match(/\\n/g) || '').length,\n                            lastGoalLine = goalLineNumber + lineCount,\n                            lastGoalColumn = goalColumnNumber + diff.value.length,\n                            lastOutputLine = outputLineNumber + lineCount,\n                            lastOutputColumn = outputColumnNumber + diff.value.length;\n                        if (diff.added || diff.removed) {\n                            mismatchCount += diff.value.length;\n                        } else {\n                            matchCount += 2*diff.value.length;\n                        }\n                        let marker = {\n                            startRow: goalLineNumber,\n                            startCol: goalColumnNumber,\n                            endRow: lastGoalLine,\n                            endCol: lastGoalColumn,\n                            className: \"change-marker warning\",\n                            type: \"text\",\n                            added: diff.added,\n                            removed: diff.removed\n                        };\n                        if ( ! diff.removed) {\n                            marker.startRow = outputLineNumber;\n                            marker.startCol = outputColumnNumber;\n                            marker.endRow = lastOutputLine;\n                            marker.endCol = lastOutputColumn;\n                        }\n                        if (lineCount > 0) {\n                            let lastNewLine = diff.value.lastIndexOf('\\n');\n                            marker.endCol = diff.value.length - lastNewLine - 1;\n                            lastGoalColumn = lastOutputColumn = marker.endCol;\n                        }\n                        if ( ! diff.added) {\n                            goalLineNumber = lastGoalLine;\n                            goalColumnNumber = lastGoalColumn;\n                        }\n                        if ( ! diff.removed) {\n                            outputLineNumber = lastOutputLine;\n                            outputColumnNumber = lastOutputColumn;\n                        }\n                        return marker;\n                    });\n                this.goalMarkers = allMarkers.filter(marker => marker.removed);\n                this.outputMarkers = allMarkers.filter(marker => marker.added);\n                allMarkers.forEach(marker => {\n                    delete marker.added;\n                    delete marker.removed;\n                });\n                this.matchPercentage = 100 * (\n                    matchCount / (matchCount + mismatchCount));\n            }\n        }\n    }\n}\n","import React, {Component} from 'react';\nimport AceEditor from 'react-ace';\nimport ReactMarkdown from 'react-markdown';\nimport SampleAnalyst from './SampleAnalyst.js';\nimport './App.css';\nimport tutorials from './tutorials.json';\n\nimport 'brace/mode/python';\nimport 'brace/mode/markdown';\nimport 'brace/theme/github';\n\nconst PythonContext = React.createContext('Python is loading...');\n\nclass ProgressBar extends Component {\n    render() {\n        let stateClass = (this.props.percentage < 50) ?\n            \"danger\" :\n            (this.props.percentage < 100) ?\n                \"warning\" :\n                \"success\";\n        return <div className=\"progressbar-wrapper \">\n            <div className={\"progressbar-filler \" + stateClass}\n                 style={{width: `${this.props.percentage}%`}}/>\n        </div>;\n    }\n}\n\nclass Editor extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {selectedLine: undefined};\n        this.content = React.createRef();\n        this.handleScroll = this.handleScroll.bind(this);\n    }\n\n    handleScroll() {\n        this.props.onScroll(this.content.current.editor.session.getScrollTop());\n    }\n\n    componentDidUpdate() {\n        this.content.current.editor.session.setScrollTop(this.props.scrollTop);\n        if (this.props.selectedLine !== this.state.selectedLine) {\n            this.setState({selectedLine: this.props.selectedLine});\n            this.content.current.editor.gotoLine(this.props.selectedLine+1);\n        }\n        this.content.current.editor.resize();\n    }\n\n    render() {\n        return <AceEditor\n            ref={this.content}\n            value={this.props.value}\n            onChange={this.props.onChange}\n            readOnly={this.props.readOnly}\n            onScroll={this.handleScroll}\n            onSelectionChange={this.props.onSelectionChange}\n            onCursorChange={this.props.onCursorChange}\n            mode={this.props.mode}\n            theme=\"github\"\n            width=\"100%\"\n            height=\"100%\"\n            fontSize={18}\n            showPrintMargin={true}\n            markers={this.props.markers}\n            showGutter={true}\n            highlightActiveLine={this.props.highlightActiveLine}\n            editorProps={{\n                $blockScrolling: Infinity\n            }}\n            setOptions={{\n                showLineNumbers: true,\n                tabSize: 4,\n            }}/>;\n    }\n}\n\nclass FootnoteBuilder extends Component {\n    render() {\n        let coreProps = {href: this.props.href};\n        if (this.props['data-sourcepos']) {\n            coreProps['data-sourcepos'] = this.props['data-sourcepos'];\n        }\n        let match = /^#(footnote\\d+)$/i.exec(coreProps.href);\n        if (match !== null) {\n            coreProps.name = match[1] + \"ref\";\n        } else {\n            match = /^#(footnote\\d+)ref$/i.exec(coreProps.href);\n            if (match !== null) {\n                coreProps.name = match[1];\n            }\n        }\n        return React.createElement('a', coreProps, this.props.children);\n    }\n}\n\nclass CodeSample extends Component {\n    static contextType = PythonContext;\n\n    constructor(props) {\n        super(props);\n        let codeRunner = this.context === null ? window.analyze : undefined,\n            analyst = new SampleAnalyst(props.value, codeRunner);\n        this.state = {\n            scrollTop: 0,\n            selectedLine: undefined,\n            isPythonLoaded: false,\n            source: analyst.sourceCode,\n            originalSource: analyst.sourceCode,\n            goalSourceCode: analyst.goalSourceCode,\n            display: analyst.display,\n            goalOutput: analyst.goalOutput,\n            output: analyst.output,\n            goalMarkers: analyst.goalMarkers,\n            outputMarkers: analyst.outputMarkers,\n            matchPercentage: analyst.matchPercentage,\n            isLive: analyst.isLive\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleReset = this.handleReset.bind(this);\n        this.handleScroll = this.handleScroll.bind(this);\n        this.handleCursorChange = this.handleCursorChange.bind(this);\n    }\n\n    handleChange(newSource) {\n        if (newSource === undefined) {\n            newSource = this.state.source;\n        }\n        let codeRunner = this.context === null ? window.analyze : undefined,\n            analyst = new SampleAnalyst(\n                newSource,\n                codeRunner,\n                this.state.goalOutput,\n                this.state.goalSourceCode,\n                this.state.isLive\n            );\n        this.setState({\n            source: newSource,\n            display: analyst.display,\n            output: analyst.output,\n            goalOutput: analyst.goalOutput,\n            goalMarkers: analyst.goalMarkers,\n            outputMarkers: analyst.outputMarkers,\n            matchPercentage: analyst.matchPercentage\n        });\n    }\n\n    handleReset() {\n        this.handleChange(this.state.originalSource);\n    }\n\n    handleScroll(scrollTop) {\n        this.setState({scrollTop: scrollTop});\n    }\n\n    handleCursorChange(selection) {\n        this.setState({selectedLine: selection.selectionLead.row});\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.context !== null) {\n            if (this.context !== this.state.display) {\n                this.setState({display: this.context});\n            }\n        }\n        else if ( ! this.state.isPythonLoaded) {\n            this.handleChange();\n            this.setState({isPythonLoaded: true});\n        }\n    }\n\n    countLines(text) {\n        return text.split(/\\r\\n|\\r|\\n/).length;\n    }\n\n    render() {\n        let displayValue = this.context;\n        if (displayValue === null) {\n            displayValue = this.state.display;\n        }\n        let displayEditor = null,\n            progressBar = null,\n            outputHeaders = null,\n            outputSection = null,\n            resetButton = null,\n            sourceLineCount = 1 + this.countLines(this.state.source);\n        if (this.state.isLive) {\n            displayEditor = <div className=\"editor-pane\">\n                <Editor\n                    value={displayValue}\n                    scrollTop={this.state.scrollTop}\n                    readOnly={true}\n                    selectedLine={this.state.selectedLine}\n                    onChange={this.handleChange}\n                    onScroll={this.handleScroll}\n                    highlightActiveLine={true}\n                    mode=\"text\"/>\n            </div>;\n        }\n        if (this.state.source !== this.state.originalSource) {\n            resetButton = <div className=\"reset-wrapper\">\n                <button className=\"reset-code\" onClick={this.handleReset}>Reset</button>\n            </div>;\n        }\n        if (this.state.goalOutput !== undefined) {\n            let outputLineCount = this.countLines(this.state.output),\n                goalLineCount = this.countLines(this.state.goalOutput),\n                outputSize = Math.min(\n                    50, 1 + Math.max(outputLineCount, goalLineCount));\n            progressBar = <ProgressBar percentage={this.state.matchPercentage}/>;\n            outputHeaders = <div className=\"editor-wrapper\">\n                <h4 className=\"editor-header\">Goal output</h4>\n                <h4 className=\"editor-header\">Your output</h4>\n            </div>;\n            outputSection = <div className=\"editor-wrapper\">\n                <div className=\"editor-pane\"\n                     style={{height: outputSize*18 + \"px\"}}>\n                    <Editor\n                        value={this.state.goalOutput}\n                        markers={this.state.goalMarkers}\n                        readOnly={true}\n                        highlightActiveLine={false}\n                        mode=\"text\"/>\n                </div>\n                <div className=\"editor-pane\">\n                    <Editor\n                        value={this.state.output}\n                        markers={this.state.outputMarkers}\n                        readOnly={true}\n                        highlightActiveLine={false}\n                        mode=\"text\"/>\n                </div>\n            </div>;\n        }\n        return (\n            <div className=\"codeSample\">\n                <div className=\"editor-wrapper\">\n                    <div className=\"editor-pane\"\n                        style={{height: sourceLineCount*18 + \"px\"}}>\n                        <Editor\n                            value={this.state.source}\n                            scrollTop={this.state.scrollTop}\n                            onChange={this.handleChange}\n                            onScroll={this.handleScroll}\n                            onCursorChange={this.handleCursorChange}\n                            highlightActiveLine={true}\n                            mode=\"python\"/>\n                    </div>\n                    {displayEditor}\n                </div>\n                {resetButton}\n                {progressBar}\n                {outputHeaders}\n                {outputSection}\n          </div>\n    );\n  }\n}\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        let app = this;\n        this.state = {\n            source: tutorials['index'],\n            pythonMessage: 'Loading Python...'\n        };\n\n        // noinspection JSUnresolvedVariable\n        if (window.languagePluginLoader === undefined) {\n            this.state.pythonMessage = 'Python is not loaded!';\n        } else {\n            // noinspection JSUnresolvedVariable\n            window.languagePluginLoader.then(function() {\n                // noinspection JSUnresolvedVariable,JSUnresolvedFunction\n                window.pyodide.loadPackage('space-tracer').then(() => {\n                    // noinspection JSUnresolvedVariable,JSUnresolvedFunction\n                    window.pyodide.runPython(\n                        'from space_tracer.main import web_main; web_main()');\n                    app.setState({pythonMessage: null});\n                });\n            });\n        }\n        let search = window.location.search;\n        let params = new URLSearchParams(search);\n        let tutorialName = params.get('tutorial');\n        if (tutorialName) {\n            this.state.source = tutorials[tutorialName];\n            if (this.state.source === undefined) {\n                this.state.source = 'Tutorial not found: ' + tutorialName;\n            }\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"app\">\n                <PythonContext.Provider value={this.state.pythonMessage}>\n                    <ReactMarkdown\n                        source={this.state.source}\n                        renderers={{\n                            code: CodeSample,\n                            link: FootnoteBuilder\n                        }}/>\n                </PythonContext.Provider>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}